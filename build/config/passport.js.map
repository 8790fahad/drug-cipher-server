{"version":3,"sources":["../../src/config/passport.js"],"names":["Users","models","User","opts","jwtFromRequest","ExtractJwt","fromAuthHeaderAsBearerToken","secretOrKey","module","exports","passport","use","JwtStrategy","jwt_payload","done","findAll","where","id","then","user","length","catch","console","log","err"],"mappings":";;AAAA;;AACA;;;;;;AAEA,IAAMA,QAAQC,iBAAOC,IAArB;;AAEA,IAAMC,OAAO,EAAb;AACAA,KAAKC,cAAL,GAAsBC,wBAAWC,2BAAX,EAAtB;AACAH,KAAKI,WAAL,GAAmB,QAAnB;AACA;AACA;;AAEA;AACAC,OAAOC,OAAP,GAAiB,oBAAY;AAC3BC,WAASC,GAAT,CACE,IAAIC,qBAAJ,CAAgBT,IAAhB,EAAsB,UAACU,WAAD,EAAcC,IAAd,EAAuB;AAC3Cd,UAAMe,OAAN,CAAc,EAAEC,OAAO,EAAEC,IAAIJ,YAAYI,EAAlB,EAAT,EAAd,EACGC,IADH,CACQ,gBAAQ;AACZ,UAAIC,KAAKC,MAAT,EAAiB;AACf,eAAON,KAAK,IAAL,EAAWK,KAAK,CAAL,CAAX,CAAP;AACD;AACD,aAAOL,KAAK,IAAL,EAAW,KAAX,CAAP;AACD,KANH,EAOGO,KAPH,CAOS;AAAA,aAAOC,QAAQC,GAAR,CAAYC,GAAZ,CAAP;AAAA,KAPT;AAQD,GATD,CADF;AAYD,CAbD","file":"passport.js","sourcesContent":["import { Strategy as JwtStrategy, ExtractJwt } from 'passport-jwt'\nimport models from '../models'\n\nconst Users = models.User;\n\nconst opts = {};\nopts.jwtFromRequest = ExtractJwt.fromAuthHeaderAsBearerToken();\nopts.secretOrKey = 'secret';\n// opts.issuer = 'accounts.examplesoft.com';\n// opts.audience = 'yoursite.net';\n\n// create jwt strategy\nmodule.exports = passport => {\n  passport.use(\n    new JwtStrategy(opts, (jwt_payload, done) => {\n      Users.findAll({ where: { id: jwt_payload.id } })\n        .then(user => {\n          if (user.length) {\n            return done(null, user[0]);\n          }\n          return done(null, false);\n        })\n        .catch(err => console.log(err));\n    })\n  );\n};\n"]}