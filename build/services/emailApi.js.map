{"version":3,"sources":["../../src/services/emailApi.js"],"names":["sendMail","sendMail2","email","subject","html","transport","from","to","then","info","console","log","messageId","catch","err","userId","id","query_type","data","userInfo","configObj","transporter","nodemailer","createTransport","smtpTransport","host","email_host","port","email_port","secure","email_secure","auth","user","email_auth_username","pass","email_auth_password","e"],"mappings":";;;;;QAMgBA,Q,GAAAA,Q;QAcAC,S,GAAAA,S;;AApBhB;;;;AACA;;AACA;;AACA;;;;;;AAGO,SAASD,QAAT,OAA4C;AAAA,MAAxBE,KAAwB,QAAxBA,KAAwB;AAAA,MAAjBC,OAAiB,QAAjBA,OAAiB;AAAA,MAARC,IAAQ,QAARA,IAAQ;;AACjDC,uBACGL,QADH,CACY;AACRM,UAAM,UADE;AAERC,QAAIL,KAFI;AAGRC,oBAHQ;AAIRC;AAJQ,GADZ,EAOGI,IAPH,CAOQ,UAACC,IAAD,EAAU;AACdC,YAAQC,GAAR,CAAY,kBAAZ,EAAgCF,KAAKG,SAArC;AACD,GATH,EAUGC,KAVH,CAUS,UAACC,GAAD;AAAA,WAASJ,QAAQC,GAAR,CAAY,OAAZ,EAAqBG,GAArB,CAAT;AAAA,GAVT;AAWD;;AAEM,SAASb,SAAT,QAA8C;AAAA,MAAzBc,MAAyB,SAAzBA,MAAyB;AAAA,MAAjBZ,OAAiB,SAAjBA,OAAiB;AAAA,MAARC,IAAQ,SAARA,IAAQ;;AACnD,uBACE;AACEY,QAAID,MADN;AAEEE,gBAAY;AAFd,GADF,EAKE,UAACC,IAAD,EAAU;AACR,QAAIC,WAAWD,KAAK,CAAL,CAAf;AACA,4BAAa,EAAED,YAAY,OAAd,EAAb,EAAsCT,IAAtC,CAA2C,UAACY,SAAD,EAAe;AACxDV,cAAQC,GAAR,CAAY,gBAAZ,EAA8BS,SAA9B;;AAEA,UAAMC,cAAcC,WAAWC,eAAX,CAClBC,cAAc;AACZC,cAAML,UAAUM,UADJ;AAEZC,cAAMP,UAAUQ,UAFJ;AAGZC,gBAAQT,UAAUU,YAHN,EAGoB;AAChCC,cAAM;AACJC,gBAAMZ,UAAUa,mBADZ;AAEJC,gBAAMd,UAAUe;AAFZ;AAJM,OAAd,CADkB,CAApB;;AAYAd,kBACGrB,QADH,CACY;AACRM,cAAM,UADE;AAERC,YAAIY,SAASjB,KAFL;AAGRC,wBAHQ;AAIRC;AAJQ,OADZ,EAOGI,IAPH,CAOQ,UAACC,IAAD,EAAU;AACdC,gBAAQC,GAAR,CAAY,kBAAZ,EAAgCF,KAAKG,SAArC;AACD,OATH,EAUGC,KAVH,CAUS,UAACC,GAAD;AAAA,eAASJ,QAAQC,GAAR,CAAY,OAAZ,EAAqBG,GAArB,CAAT;AAAA,OAVT;AAWD,KA1BD;AA2BD,GAlCH,EAmCE,UAACsB,CAAD,EAAO;AACL1B,YAAQC,GAAR,CAAYyB,CAAZ;AACD,GArCH;AAuCD","file":"emailApi.js","sourcesContent":["import transport from '../config/nodemailer'\nimport { appConfigApi } from '../queries/misc'\nimport { usersApi } from '../queries/users'\nimport path from 'path'\n\n\nexport function sendMail({ email, subject, html }) {\n  transport\n    .sendMail({\n      from: 'BitCoops',\n      to: email,\n      subject,\n      html,\n    })\n    .then((info) => {\n      console.log('Message sent: %s', info.messageId)\n    })\n    .catch((err) => console.log('Error', err))\n}\n\nexport function sendMail2({ userId, subject, html }) {\n  usersApi(\n    {\n      id: userId,\n      query_type: 'info',\n    },\n    (data) => {\n      let userInfo = data[0]\n      appConfigApi({ query_type: 'email' }).then((configObj) => {\n        console.log('Email config: ', configObj)\n\n        const transporter = nodemailer.createTransport(\n          smtpTransport({\n            host: configObj.email_host,\n            port: configObj.email_port,\n            secure: configObj.email_secure, // secure:true for port 465, secure:false for port 587\n            auth: {\n              user: configObj.email_auth_username,\n              pass: configObj.email_auth_password,\n            },\n          }),\n        )\n\n        transporter\n          .sendMail({\n            from: 'BitCoops',\n            to: userInfo.email,\n            subject,\n            html,\n          })\n          .then((info) => {\n            console.log('Message sent: %s', info.messageId)\n          })\n          .catch((err) => console.log('Error', err))\n      })\n    },\n    (e) => {\n      console.log(e)\n    },\n  )\n}\n"]}